<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sources PUBLIC
  "-//Penrose/DTD Sources ${product.specification}//EN"
  "http://penrose.safehaus.org/dtd/sources.dtd">

<sources>

  <source name="users">
    <connection-name>MySQL</connection-name>
    <field name="username" primaryKey="true"/>
    <field name="firstName"/>
    <field name="lastName"/>
    <field name="password"/>
    <parameter>
      <param-name>table</param-name>
      <param-value>users</param-value>
    </parameter>
  </source>

  <source name="users_changelog">
    <connection-name>MySQL</connection-name>
    <field name="changeNumber" type="INTEGER" primaryKey="true"/>
    <field name="changeTime"/>
    <field name="changeAction"/>
    <field name="changeUser"/>
    <field name="username"/>
    <field name="firstName"/>
    <field name="lastName"/>
    <field name="password"/>
    <parameter>
      <param-name>table</param-name>
      <param-value>users_changelog</param-value>
    </parameter>
  </source>

  <source name="groups">
    <connection-name>MySQL</connection-name>
    <field name="groupname" primaryKey="true"/>
    <parameter>
      <param-name>table</param-name>
      <param-value>groups</param-value>
    </parameter>
  </source>

  <source name="usergroups">
    <connection-name>MySQL</connection-name>
    <field name="groupname" primaryKey="true"/>
    <field name="username" primaryKey="true"/>
    <parameter>
      <param-name>table</param-name>
      <param-value>usergroups</param-value>
    </parameter>
  </source>

  <source name="users_cache">
    <connection-name>Cache</connection-name>
    <field name="username" primaryKey="true">
      <variable>users.username</variable>
    </field>
    <field name="firstName">
      <variable>users.firstName</variable>
    </field>
    <field name="lastName">
      <variable>users.lastName</variable>
    </field>
    <field name="password">
      <variable>users.password</variable>
    </field>
    <parameter>
      <param-name>table</param-name>
      <param-value>users_cache</param-value>
    </parameter>
  </source>

  <source name="groups_cache">
    <connection-name>Cache</connection-name>
    <field name="groupname" primaryKey="true">
      <variable>groups.groupname</variable>
    </field>
    <parameter>
      <param-name>table</param-name>
      <param-value>groups_cache</param-value>
    </parameter>
  </source>

  <source name="usergroups_cache">
    <connection-name>Cache</connection-name>
    <field name="groupname" primaryKey="true">
      <variable>usergroups.groupname</variable>
    </field>
    <field name="username" primaryKey="true">
      <variable>usergroups.username</variable>
    </field>
    <parameter>
      <param-name>table</param-name>
      <param-value>usergroups_cache</param-value>
    </parameter>
  </source>

  <source name="tracker">
    <connection-name>Cache</connection-name>
    <field name="sourceName" primaryKey="true" caseSensitive="true"/>
    <field name="changeNumber" type="INTEGER"/>
    <parameter>
      <param-name>table</param-name>
      <param-value>tracker</param-value>
    </parameter>
  </source>

  <source-sync name="users">
    <class-name>org.safehaus.penrose.source.jdbc.JDBCSourceSync</class-name>
    <parameter>
      <param-name>source</param-name>
      <param-value>users</param-value>
    </parameter>
    <parameter>
      <param-name>changelog</param-name>
      <param-value>users_changelog</param-value>
    </parameter>
    <parameter>
      <param-name>tracker</param-name>
      <param-value>tracker</param-value>
    </parameter>
  </source-sync>

  <source-sync name="groups">
    <class-name>org.safehaus.penrose.source.jdbc.JDBCSourceSync</class-name>
    <parameter>
      <param-name>source</param-name>
      <param-value>groups</param-value>
    </parameter>
  </source-sync>

  <source-sync name="usergroups">
    <class-name>org.safehaus.penrose.source.jdbc.JDBCSourceSync</class-name>
    <parameter>
      <param-name>source</param-name>
      <param-value>usergroups</param-value>
    </parameter>
  </source-sync>

</sources>
